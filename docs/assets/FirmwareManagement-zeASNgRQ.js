import{d as k,a as u,o,b as M,aF as z,aC as D,J as b,f as n,w as r,u as a,al as q,aG as J,aH as m,aI as f,K as g,g as F,t as v,aJ as R}from"./index-CjCmZfvA.js";import{a as w,N as U,b as i}from"./api-DGTtdmy1.js";import{N as p}from"./Input-B8IVPq-t.js";const H={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},L=k({name:"DeleteFilled",render:function(N,s){return o(),u("svg",H,s[0]||(s[0]=[M("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",fill:"currentColor"},null,-1)]))}}),O={class:"p-4"},h={key:0},E=k({__name:"FirmwareManagement",setup(C){const{mutate:N,isPending:s}=z(w.pet.addFirmware),{data:P,isPending:_}=D(w.pet.getFirmwares,{}),{mutate:I,isPending:c}=z(w.pet.removeFirmware),y=b(null),K={name:{required:!0,message:"Please input name",trigger:["input"]},fileName:{required:!0,message:"Please input file name",trigger:["input"]},md5:{required:!0,message:"Please input md5",trigger:"blur"},size:{required:!0,message:"Please input size",trigger:["input","blur"]}},t=b({name:"",md5:"",size:"",fileName:""}),S=async d=>{d.preventDefault(),y?.value?.validate(async e=>{if(!e)await N({fileName:t.value.fileName,md5:t.value.md5,size:t.value.size,name:t.value.name}),t.value.md5="",t.value.size="",t.value.fileName="",t.value.name="";else return console.log("error submit!!"),!1})},V=async d=>{d.preventDefault();const e=prompt("粘贴JSON格式的固件信息到此处:");if(!e)return;const l=JSON.parse(e);if(l){t.value.name="";const x=l.url.lastIndexOf("/"),B=l.url.substring(x+1);t.value.fileName=B,t.value.md5=l.md5,t.value.size=l.size}else alert("Clipboard content is not in the correct format.")};return(d,e)=>(o(),u("div",O,[n(a(U),{ref_key:"formRef",ref:y,inline:"",model:t.value,rules:K},{default:r(()=>[n(a(i),{path:"name",label:"名称(你自己好记的名字)"},{default:r(()=>[n(a(p),{value:t.value.name,"onUpdate:value":e[0]||(e[0]=l=>t.value.name=l),valueModifiers:{trim:!0},onKeydown:e[1]||(e[1]=m(f(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),n(a(i),{path:"md5",label:"Md5"},{default:r(()=>[n(a(p),{value:t.value.md5,"onUpdate:value":e[2]||(e[2]=l=>t.value.md5=l),valueModifiers:{trim:!0},onKeydown:e[3]||(e[3]=m(f(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),n(a(i),{path:"size",label:"Size"},{default:r(()=>[n(a(p),{value:t.value.size,"onUpdate:value":e[4]||(e[4]=l=>t.value.size=l),valueModifiers:{trim:!0},onKeydown:e[5]||(e[5]=m(f(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),n(a(i),{ref:"rPasswordFormItemRef",first:"",path:"fileName",label:"File Name"},{default:r(()=>[n(a(p),{value:t.value.fileName,"onUpdate:value":e[6]||(e[6]=l=>t.value.fileName=l),valueModifiers:{trim:!0},width:"160",onKeydown:e[7]||(e[7]=m(f(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},512),n(a(i),null,{default:r(()=>[n(a(g),{type:"primary",loading:a(s),onClick:S},{default:r(()=>e[8]||(e[8]=[F(" 添加 ")])),_:1},8,["loading"])]),_:1}),n(a(i),null,{default:r(()=>[n(a(g),{loading:a(s),onClick:V},{default:r(()=>e[9]||(e[9]=[F(" 粘贴 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),a(_)?(o(),u("p",h,"Loading....")):(o(!0),u(q,{key:1},J(a(P),l=>(o(),u("div",{key:l._id,class:"mt-2 p-2 border border-gray-300 rounded flex justify-between items-center"},[M("div",null," Name: "+v(l.name)+" - File Name: "+v(l.fileName)+" - Md5: "+v(l.md5)+" - Size: "+v(l.size),1),n(a(g),{text:"",loading:a(c),style:{"font-size":"24px"},onClick:x=>a(I)({id:l._id})},{default:r(()=>[n(a(R),{color:"red"},{default:r(()=>[n(a(L))]),_:1})]),_:2},1032,["loading","onClick"])]))),128))]))}});export{E as default};
